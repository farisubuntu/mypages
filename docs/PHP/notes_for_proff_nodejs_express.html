<!DOCTYPE html>
<html lang="en">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
	crossorigin="anonymous">
<link rel="stylesheet" href="../prism.css">
<link rel="stylesheet" href="../styles.css">
<style>

</style>
<body>

	<nav>
		<ul>
<li><a class="" href="../index.html">index</a></li>
<li class="heading"><span>CSS</span></li>
<ul>
<li><a class="" href="../CSS/css-media-and-rwd.html">css media and rwd</a></li>
<li><a class="" href="../CSS/css-naming-convention.html">css naming convention</a></li>
<li><a class="" href="../CSS/css_page_media.html">css page media</a></li>
<li><a class="" href="../CSS/flexbox-review.html">flexbox review</a></li>
<li><a class="" href="../CSS/grid-review.html">grid review</a></li>
<li><a class="" href="../CSS/notes_grid_or_flexbox.html">notes grid or flexbox</a></li>
<li><a class="" href="../CSS/rwd-snippets.html">rwd snippets</a></li>
<li><a class="" href="../CSS/sizing_items_in_css.html">sizing items in css</a></li>
</ul>
<li class="heading"><span>Github</span></li>
<ul>
<li><a class="" href="../Github/gcm.html">gcm</a></li>
<li><a class="" href="../Github/git-branching.html">git branching</a></li>
<li><a class="" href="../Github/git-flight-rules.html">git flight rules</a></li>
<li><a class="" href="../Github/git-gcm-configure.html">git gcm configure</a></li>
<li><a class="" href="../Github/git.html">git</a></li>
<li><a class="" href="../Github/gitpod.html">gitpod</a></li>
<li><a class="" href="../Github/integrate_github_with_wordpress.html">integrate github with wordpress</a></li>
<li><a class="" href="../Github/md-to-github.html">md to github</a></li>
</ul>
<li class="heading"><span>Leaf 3</span></li>
<ul>
<li><a class="" href="../Leaf-3/basic.html">basic</a></li>
<li><a class="" href="../Leaf-3/helpers.html">helpers</a></li>
<li><a class="" href="../Leaf-3/mvc.html">mvc</a></li>
</ul>
<li class="heading"><span>Network Net</span></li>
<ul>
<li><a class="" href="../Network_Net/anonsurf_vpn_install.html">anonsurf vpn install</a></li>
<li><a class="" href="../Network_Net/dd-wrt.html">dd wrt</a></li>
<li><a class="" href="../Network_Net/dd-wrt_multiple_bssids.html">dd wrt multiple bssids</a></li>
<li><a class="" href="../Network_Net/ddwrt_basic_wl_settings.html">ddwrt basic wl settings</a></li>
<li><a class="" href="../Network_Net/download_youtube_videos.html">download youtube videos</a></li>
<li><a class="" href="../Network_Net/riseup-vpn.html">riseup vpn</a></li>
</ul>
<li class="heading"><span>PHP</span></li>
<ul>
<li><a class="" href="22092023.html">22092023</a></li>
<li><a class="" href="LearningResources.html">LearningResources</a></li>
<li><a class="" href="edx_js_backend_frameworks.html">edx js backend frameworks</a></li>
<li><a class="" href="embed_lib.html">embed lib</a></li>
<li><a class="" href="express_mdn.html">express mdn</a></li>
<li><a class="" href="helpful_resources.html">helpful resources</a></li>
<li><a class="" href="html_forms.html">html forms</a></li>
<li><a class="" href="http_response_codes.html">http response codes</a></li>
<li><a class="" href="json_guide.html">json guide</a></li>
<li><a class="" href="local-servers.html">local servers</a></li>
<li><a class="" href="logical_gradation_of_developers.html">logical gradation of developers</a></li>
<li><a class="" href="markdown.html">markdown</a></li>
<li><a class="" href="namespace_review.html">namespace review</a></li>
<li><a class="active" href="notes_for_proff_nodejs_express.html">notes for proff nodejs express</a></li>
<li><a class="" href="npm_quick_ref.html">npm quick ref</a></li>
<li><a class="" href="pandoc_quick_ref.html">pandoc quick ref</a></li>
<li><a class="" href="php_basics.html">php basics</a></li>
<li><a class="" href="php_iterators.html">php iterators</a></li>
<li><a class="" href="wget-ultimate-examples.html">wget ultimate examples</a></li>
</ul>
<li class="heading"><span>Packaging</span></li>
<ul>
<li><a class="" href="../Packaging/apt.html">apt</a></li>
<li><a class="" href="../Packaging/composer.html">composer</a></li>
</ul>
<li class="heading"><span>ReviewQuestions</span></li>
<ul>
<li><a class="" href="../ReviewQuestions/strings_quotes.html">strings quotes</a></li>
</ul>
<li class="heading"><span>Symfony</span></li>
<ul>
<li><a class="" href="../Symfony/Encore.html">Encore</a></li>
<li class="heading"><span>Symfonycasts</span></li>
<ul>
<li><a class="" href="../Symfony/Symfonycasts/Composer.html">Composer</a></li>
<li><a class="" href="../Symfony/Symfonycasts/Dependency Injection and the art of services and containers.html">Dependency Injection and the art of services and containers</a></li>
<li><a class="" href="../Symfony/Symfonycasts/Symfony 6 Fundamentals: Services, Config & Environments.html">Symfony 6 Fundamentals: Services, Config & Environments</a></li>
</ul>
<li><a class="" href="../Symfony/chapter5_symfonyCats.html">chapter5 symfonyCats</a></li>
<li><a class="" href="../Symfony/symfony_and_http_fundamentals.html">symfony and http fundamentals</a></li>
<li><a class="" href="../Symfony/symfony_basics.html">symfony basics</a></li>
<li><a class="" href="../Symfony/twig_basics.html">twig basics</a></li>
<li><a class="" href="../Symfony/twig_cheatsheet.html">twig cheatsheet</a></li>
</ul>
<li class="heading"><span>javascript</span></li>
<ul>
<li><a class="" href="../javascript/js_cheatsheet.html">js cheatsheet</a></li>
</ul>
</ul>
	</nav>
	<article>
	<h3 id="basic-routing%3A">Basic Routing: <a class="heading-anchor-permalink" href="#basic-routing%3A">#</a></h3>
<p>First create an express app:</p>
<pre><code class="language-js">const express =  require('express');
const app =  express();
</code></pre>
<p>Then you can define routes like this:</p>
<pre><code class="language-js">
app.get('/someUri', function (req, res, next) {})

</code></pre>
<p>That structure works for all <code>HTTP</code> methods, and expects a path as the first argument, and a handler for that path, which receives the request and response objects. So, for the basic <code>HTTP</code> methods, these are the routes</p>
<pre><code class="language-js">
// GET www.domain.com/myPath

app.get('/myPath', function (req, res, next) {})

// POST www.domain.com/myPath

app.post('/myPath', function (req, res, next) {})

// PUT www.domain.com/myPath

app.put('/myPath', function (req, res, next) {})

// DELETE www.domain.com/myPath

app.delete('/myPath', function (req, res, next) {})

</code></pre>
<p>You can check the complete list of supported verbs here. If you want to define the same behavior for a route and all <code>HTTP</code> methods, you can use:</p>
<pre><code class="language-js">
app.all('/myPath', function (req, res, next) {})

//or

app.use('/myPath', function (req, res, next) {})

//or

app.use('*', function (req, res, next) {})

// * wildcard will route for all paths

</code></pre>
<p>You can chain your route definitions for a single path</p>
<pre><code class="language-js">
app.route('/myPath')

.get(function (req, res, next) {})

.post(function (req, res, next) {})

.put(function (req, res, next) {})

</code></pre>
<p>You can also add functions to any <code>HTTP</code> method. They will run before the final callback and take the parameters <code>(req, res, next)</code> as arguments.</p>
<pre><code class="language-js">
// GET www.domain.com/myPath

app.get('/myPath', myFunction, function (req, res, next) {})

</code></pre>
<p>Your final callbacks can be stored in an external file to avoid putting too much code in one file:</p>
<pre><code class="language-js">
// other.js

exports.doSomething  =  function(req, res, next) {/* do some stuff */};

</code></pre>
<p>And then in the file containing your routes:</p>
<pre><code class="language-js">
const other =  require('./other.js');

app.get('/someUri', myFunction, other.doSomething);

</code></pre>
<h3 id="section-3.4%3A-using-a-template-engine">Section 3.4: Using a Template Engine <a class="heading-anchor-permalink" href="#section-3.4%3A-using-a-template-engine">#</a></h3>
<p>The following code will setup Jade as template engine. (Note: Jade has been renamed to pug as of December 2015.)</p>
<pre><code class="language-js">
const express =  require('express'); //Imports the express module

const app =  express(); //Creates an instance of the express module

const PORT =  3000; //Randomly chosen port

  

app.set('view engine','jade'); //Sets jade as the View Engine / Template Engine

app.set('views','src/views'); //Sets the directory where all the views (.jade files) are stored.

  

//Creates a Root Route

app.get('/',function(req, res){

res.render('index'); //renders the index.jade file into html and returns as a response. The render function optionally takes the data to pass to the view.

});

  

//Starts the Express server with a callback

app.listen(PORT, function(err) {

if (!err) {

console.log('Server is running at port', PORT);

} else {

console.log(JSON.stringify(err));

}

});

  

</code></pre>
<blockquote>
<p>Remember to <code>npm install</code> the Template Engine too such <code>hbs</code>,<code>jade/pug</code> or <code>ejs</code>.</p>
</blockquote>
<hr>
<h3 id="section-3.5%3A-json-api-with-expressjs">Section 3.5: JSON API with ExpressJS <a class="heading-anchor-permalink" href="#section-3.5%3A-json-api-with-expressjs">#</a></h3>
<pre><code class="language-js">
var express =  require('express');

  

var cors =  require('cors'); // Use cors module for enable Cross-origin resource sharing

  

var app =  express();

app.use(cors()); // for all routes

  

var port = process.env.PORT ||  8080;

  

app.get('/', function(req, res) {

var info = {

'string_value': 'StackOverflow',

  

'number_value':}

res.json(info);

8476

// or

/* res.send(JSON.stringify({

string_value: 'StackOverflow',

number_value: 8476

})) */

//you can add a status code to the json response

/* res.status(200).json(info) */

})

app.listen(port, function() {

console.log('Node.js listening on port '  + port)

})

</code></pre>
<p>On <a href="http://localhost:8080/">http://localhost:8080/</a> output object</p>
<pre><code class="language-json">
{

string_value:&quot;StackOverflow&quot;,

number_value:8476

}

</code></pre>
<h3 id="section-3.6%3A-serving-static-files">Section 3.6: Serving static files <a class="heading-anchor-permalink" href="#section-3.6%3A-serving-static-files">#</a></h3>
<p>When building a webserver with Express it’s often required to serve a combination of dynamic content and static</p>
<p>files.</p>
<p>It is common to use folder named ‘public’ to have static files. In this case the folder structure may look like:</p>
<pre><code class="language-bash">
project root

├── server.js

├── package.json

└── public

├── index.html

└── script.js

</code></pre>
<p>To configure Express to serve static files:</p>
<pre><code class="language-js">
app.use(express.static('public'));

</code></pre>
<p>you must not specify /public/ in the url). This is because, express looks up for the files relative to the static folder configured. You can specify virtual path prefix as shown below:</p>
<pre><code class="language-js">
app.use('/static', express.static('public'));

</code></pre>
<p>This will make the resources available under the <code>/static/</code> prefix.</p>
<p>To define multiple folders at the same time:</p>
<pre><code class="language-js">
app.use(express.static('public'));

app.use(express.static('images'));

app.use(express.static('files'));

</code></pre>
<blockquote>
<p>Express will examine the folder in definition order. In case of files with the same name, the one in the first matching folder will be served.</p>
</blockquote>
<hr>
<h3 id="section-3.7%3A-adding-middleware">Section 3.7: Adding Middleware <a class="heading-anchor-permalink" href="#section-3.7%3A-adding-middleware">#</a></h3>
<p>[x] add more about <code>middleware</code> functions</p>
<p><strong>Middleware functions are functions that have access to the request object (req), the response object (res), and the next middleware function in the application’s request-response cycle.</strong></p>
<h2 id="middleware-functions-can-execute-any-code%2C-make-changes-to-res-and-req-objects%2C-end-response-cycle-and-call-next-middleware.">Middleware functions can execute any code, make changes to res and req objects, end response cycle and call next middleware. <a class="heading-anchor-permalink" href="#middleware-functions-can-execute-any-code%2C-make-changes-to-res-and-req-objects%2C-end-response-cycle-and-call-next-middleware.">#</a></h2>
<h3 id="section-3.9%3A-getting-info-from-the-request">Section 3.9: Getting info from the request <a class="heading-anchor-permalink" href="#section-3.9%3A-getting-info-from-the-request">#</a></h3>
<p>To get info from the requesting url (notice that req is the request object in the handler function of routes).</p>
<p>Consider this route definition <code>/settings/:user_id</code> and this particular example <code>/settings/32135?field=name</code></p>
<pre><code class="language-js">
// get the full path

req.originalUrl // =&gt; /settings/32135?field=name

  

// get the user_id param

req.params.user_id // =&gt; 32135

// get the query value of the field
req.query.field // =&gt; 'name'

</code></pre>
<p>You can also get headers of the request, like this</p>
<pre><code class="language-js">
req.get('Content-Type') // &quot;text/plain&quot;

</code></pre>
<p>To simplify getting other info you can use middlewares. For example, to get the body info of the request, you can use the body-parser middleware, which will transform raw request body into usable format.</p>
<pre><code class="language-js">
var app =  require('express')();

var bodyParser =  require('body-parser');

app.use(bodyParser.json()); // for parsing application/json

app.use(bodyParser.urlencoded({ extended: true })); // for parsing application/x-www-form-urlencoded

</code></pre>
<p>Now suppose a request like this</p>
<pre><code class="language-http">
PUT /settings/32135

{

&quot;name&quot;: &quot;Peter&quot;

}

</code></pre>
<p>You can access the posted name like this</p>
<pre><code class="language-js">
req.body.name // &quot;Peter&quot;

</code></pre>
<p>In a similar way, you can access cookies from the request, you also need a middleware like cookie-parser</p>
<pre><code class="language-js">
req.cookies.name

</code></pre>
<h3 id="section-3.11%3A-hook%3A-how-to-execute-code-before-any-req-and-after-any-res">Section 3.11: Hook: How to execute code before any <code>req</code> and after any <code>res</code> <a class="heading-anchor-permalink" href="#section-3.11%3A-hook%3A-how-to-execute-code-before-any-req-and-after-any-res">#</a></h3>
<p>app.use() and middleware can be used for “before” and a combination of the close and finish events can be used for “after”.</p>
<pre><code class="language-js">app.use(function (req, res, next) {
function  afterResponse() {
res.removeListener('finish', afterResponse);
res.removeListener('close', afterResponse);
// actions after response
}
res.on('finish', afterResponse);
res.on('close', afterResponse);
// action before request
// eventually calling 'next()'
next();
});
app.use(app.router);
</code></pre>
<blockquote>
<p>Note: Just make sure this “middleware” is used before app.router as order does matter.</p>
</blockquote>
<hr>
<h3 id="section-3.13%3A-custom-middleware-in-express">Section 3.13: Custom middleware in Express <a class="heading-anchor-permalink" href="#section-3.13%3A-custom-middleware-in-express">#</a></h3>
<p>In Express, you can define middlewares that can be used for checking requests or setting some headers in response.</p>
<pre><code class="language-js">app.use(function(req, res, next){ }); // signature
</code></pre>
<p>Example</p>
<p>The following code adds user to the request object and pass the control to the next matching route.</p>
<pre><code class="language-js">var express =  require('express');
var app =  express();
//each request will pass through it
app.use(function(req, res, next){
req.user =  'testuser';
next(); // it will pass the control to next matching route
});
app.get('/', function(req, res){
var user = req.user;
console.log(user); // testuser
return res.send(user);
});
app.listen(3000);
</code></pre>

	</article>
	<script src="../prism.js"></script>
	<script>prism.Highlight();</script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
</body>

</html>